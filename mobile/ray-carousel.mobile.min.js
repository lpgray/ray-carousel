/** ray-carousel v0.1.0 
 * Copyright zhangyang Build: 2015-01-11 13:15:47
 **/!function(a){"use strict";console.log("welcome to use ray-carousel"),a.RayCarousel={version:"0.1.0"}}(this),function(a,b){"use strict";function c(a,b){var c=this;c.$elem=a,c.options=b,c.initTemplate(),c.bindEvent(),c.autoRun()}var d=a(window),e=d.width();c.fn=c.prototype,c.fn.initTemplate=function(){var b,c=this,d="",f="",g=0,h=c.$elem.children(":last-child"),i=document.createElement("div");i.appendChild(h.clone()[0]);var j=i.innerHTML;c.$elem.children().each(function(c){var e=a(this),h=document.createElement("div");h.appendChild(e.clone()[0]),0===c&&(b=h.innerHTML,d+='<div class="xct-inner">',d+='<div class="xct-item">'+j+"</div>"),d+='<div class="xct-item">'+h.innerHTML+"</div>",f+=0===c?'<span class="active"></span>':"<span></span>",g++}),d+='<div class="xct-item">'+b+"</div>",d+="</div>",d+='<div class="xct-points">'+f+"</div>",c.$elem.html(d),c.$inner=c.$elem.find(".xct-inner"),c.$inner.children().width(e),c.$inner.width(e*(g+2)),c.currentIndex=0,c.move(),c.$inner.bind("transitionend webkitTransitionEnd",function(){c.$inner.css({transition:"none","-webkit-transition":"none"}),c.currentIndex===g?c.currentIndex=0:-1===c.currentIndex&&(c.currentIndex=g-1),c.move(),c.animating=!1}),c.$points=c.$elem.find(".xct-points").children(),c.number=g},c.fn.bindEvent=function(){var a,b,c=this;c.$inner.bind("touchstart",function(d){return c.pause=!0,c.animating?!1:(b=new Date,a=d.changedTouches[0].clientX,d.preventDefault(),void d.stopPropagation())}).bind("touchmove",function(b){if(c.animating)return!1;var d=b.changedTouches[0].clientX,e=d-a;c.$inner.css({"-webkit-transform":"translate3d("+(c.currentPosX+e)+"px, 0px, 0px)","-ms-transform":"translate3d("+(c.currentPosX+e)+"px, 0px, 0px)",transform:"translate3d("+(c.currentPosX+e)+"px, 0px, 0px)"}),b.preventDefault(),b.stopPropagation()}).bind("touchend",function(d){if(c.pause=!1,c.animating)return!1;var e=new Date,f=d.changedTouches[0].clientX,g=f-a;Math.abs(g)>100?0>g?c.next():c.prev():e.getTime()-b.getTime()<150?(c.options.itemTapped&&c.options.itemTapped.call(c,d.target),c.reset()):c.reset(),d.preventDefault(),d.stopPropagation()}),d.resize(function(){c.resize()})},c.fn.next=function(){var a=this;return a.animating?!1:(a.currentIndex++,a.animating=!0,a.moveWithTransition(),void a.activePoint(a.currentIndex))},c.fn.prev=function(){var a=this;return a.animating?!1:(a.currentIndex--,a.animating=!0,a.moveWithTransition(),void a.activePoint(a.currentIndex))},c.fn.reset=function(){var a=this;a.animating=!1,a.moveWithTransition()},c.fn.activePoint=function(b){var c,d=this;c="number"==typeof b?b===d.number?0:-1===b?d.number-1:b:d.currentIndex,d.$points.each(function(b){b===c?a(this).addClass("active"):a(this).removeClass("active")})},c.fn.autoRun=function(){var a=this;a.options.autoRun&&a.options.pause&&(a.timing=setInterval(function(){a.pause||a.next()},a.options.pause))},c.fn.move=function(){var a=this;a.currentPosX=-(a.currentIndex+1)*e,a.$inner.css({"-webkit-transform":"translate3d("+a.currentPosX+"px, 0px, 0px)","-ms-transform":"translate3d("+a.currentPosX+"px, 0px, 0px)",transform:"translate3d("+a.currentPosX+"px, 0px, 0px)"})},c.fn.moveWithTransition=function(){var a=this;a.currentPosX=-(a.currentIndex+1)*e,a.$inner.css({"-webkit-transition":"all .5s ease",transition:"all .5s ease","-webkit-transform":"translate3d("+a.currentPosX+"px, 0px, 0px)","-ms-transform":"translate3d("+a.currentPosX+"px, 0px, 0px)",transform:"translate3d("+a.currentPosX+"px, 0px, 0px)"})},c.fn.resize=function(){var a=this;e=d.width(),a.$inner.children().width(e),a.$inner.width(e*(number+2))},b.Mobile=c}(Zepto,this.RayCarousel);